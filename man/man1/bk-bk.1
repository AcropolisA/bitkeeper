.so ../bk-macros
.TH "bk" "\*[BKVER]" %E% "\*(BC" "\*(UM"
.SH NAME
bk \- \*(BK configuration management system front end
.SH SYNOPSIS
.B bk 
.[B] \-A|U|r
.[OPTreq] \-s alias
.[B] options
.ARG command 
.[ARG] options
.SH DESCRIPTION
.B bk
is the front end to all \*(BK commands.
All \*(BK commands are prefixed with 
.B bk
in order to avoid ambiguity with
non-\*(BK commands that might be already installed on the system such as 
.B bk co
and
.BR "bk ci" .
.LP
If you are looking for instructions on how to get started, try running the
test drive at
.BR http://www.bitkeeper.com/Test.html .
.SH OPTIONS
Only the global options are documented here.
To see command specific options consult the documentation for the command
in question (bk help
.ARG command ).
.de TPP
.TP -s[\*<alias\*>]\ 
..
.TPP
.OPTopt \-@ url
Run the command in the specified repository rather than locally.
If
.ARG url
is not specified, then use the parent[s] of the current repository.
If there are multiple parents, incoming and/or outgoing, use all of those
parents.
You can use the construct
.OPTreq \-@@ file
to specify a file containing a list of repository URLs, one per line;
the command is run in each of the remote repositories.
.IP
The
.OPTopt \-r dir
option works as expected, running the command recursively over all
of the implied files.
If specified,
.ARG dir
must be relative to the root of the remote repository.
.IP
If 
.Q \-
is the last argument, then the standard input is read and buffered.
Each remote command receives the same input.
.TPP
.B \-A
Starting at the current working directory, run
.ARG command
on all files in the entire repository or nested collection.
In a standalone repository this option is similar to
.BR \-r .
For example, to search all files in a nested collection:
.DS
$ bk -A grep 'the string I want to find'
.DE
See \-s below for ways to limit the set of files processed in a nested
collection.
.TPP
\fB--cd\fR=\*<dir\*>
Change to
.ARG dir
before running the command.
.TPP
.B \--headers
For remote commands (\-@)
.if \n[NESTED] or for nested collection iterators,
this option causes the output
from running the command in each repository to prefixed with a header:
.DS
#### \*<repo-url or location\*> ####
.DE
.if \n[NESTED] \{\
.TPP
.B \-P
Change directories to the root of the product repository before running
.ARG command .
Same as 
.B \-R
in a non-nested collection.
.\}
.TPP
.B \-R
Change directories to the root of the repository before running
.ARG command .
.TPP
.OPTopt \-r dir
Starting at 
.ARG dir ,
or the repository root if 
.ARG dir
was not specified, apply
.ARG command
recursively to
.ARG dir
and all subdirectories.
This works by generating a list of files and passing them to
.ARG command
on the standard input.
.if \n[NESTED] \{\
.TPP
.OPTopt \-s alias
If not combined with -A/-U, this is a nested collection iterator that
runs the command at the root of each selected component/product.
If
.ARG alias
is not present, it defaults to "HERE" which means run the command
in each component and then the product.
For example, to integrity check all the components and the product
in succession:
.DS
$ bk -s -r check -acv
.DE
though "bk repocheck" is easier to type and does the same thing.
.sp .5
If 
.ARG alias
is present, then it restricts the command to run in the specified
alias[es].
The option may be repeated to specify multiple aliases,
the alias may be a component,
and the alias may be negated.
To run everywhere except the product:
.DS
$ bk -s^PRODUCT grep 'something only if in a component'
.DE
.sp .5
When combined with
.B \-A
or
.BR \-U ,
.OPTreq \-s alias
limits the files processed to those implied by
.ARG alias .
.sp .5
In a standalone repository this option has no effect.
.TPP
.B \-U
In a nested collection,
starting at the current working directory, run
.ARG command
on all active (not deleted and not BitKeeper metadata )
files in the entire collection, components and
product.
For example, to check out your collection:
.DS
$ bk -U co
.DE
See \-s above for ways to limit the set of files processed in a nested
collection.
.\}
.TPP
.B \-1acpx
One or more of these options may be used in combination with 
.Q \-r
to limit the set of files passed to
.ARG command .
.\" HEY!  YOU!  Man page hacker.  If you change these make sure you follow
.\" whatever bk-sfiles.1 says, that's the authoritative source, OK?  Thanks!
.RS
.TP ABCD
.B \-1
Only examine the current (or named) directory.
Do not go into subdirectories.
.tp
.B \-a
Examine all files, even if listed in
.BR BitKeeper/etc/ignore .
.tp
.B \-c
List changed files (locked and modified).
See EXAMPLES below for a typical usage.
.tp
.B \-p
List files with pending deltas.  
.tp
.B \-x
List files which have no revision control files.
See EXAMPLES below for a typical usage.
.RE
.SH EXIT STATUS
Unless otherwise documented, all \*(BK commands return exit status
0 on success and greater than 0 on failure.
.SH EXAMPLES
.LP
The following commands are equivalent:
.DS 6
bk -r co
bk -R sfiles | bk -R co -
cd \`bk root\`; bk sfiles | bk co -
.DE
An example usage for generating a patch of all new and/or changed files:
.DS
$ bk -cxU diffs -Nu
.DE
.SH "SEE ALSO"
.SA sfiles
.SH CATEGORY
.B Repository
.if \n[NESTED] \{\
.SH AVAILABILITY
The \-P/\-s/ options of this command are an optional feature of \*[BK]
and must be enabled in your license.
To see if your license is so enabled, run 
.DS
bk lease renew
bk lease show
.DE
If the options field has "SAM" or "PL" listed then your
license has this feature enabled.
If not, contact BitMover sales.
.\}
