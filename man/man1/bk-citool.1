.so ../bk-macros
.TH "bk citool" 1 20%E% "\*(BC" "\*(UM"
.SH NAME
bk citool \- \*(BK graphical check-in tool
.SH SYNOPSIS
.Bc bk citool [
.ARG dir
.B | 
.ARGc file_list
.B ]
.SH DESCRIPTION
The
.B citool
application is a graphical interface for checking in new, modified,
and pending files.  When called with no arguments,
.B citool
examines the current repository for files requiring checkin. Otherwise,
.B citool
will look in the list of arguments for files or directories.  The
arguments are processed by
.B bk
.BR sfiles ,
and have to follow the restrictions imposed by
.B bk
.BR sfiles .
.LP
Citool has three main windows that are positioned vertically.
The top window contains the list of files that can be checked in to a
changeset.  The middle window is used for entering comments about the
selected file while the bottom window displays different things depending
on whether viewing a modified file or a file not under revision
control. For modified files, the differences between the modified file
and its parent are shown and for new files, the file contents are
shown.
.LP
Along the upper right side of the upper two windows are a group
of buttons. Some of the buttons have different purposes depending
on what the user is doing.  For example, the Checkin/Commit button
becomes the Commit button when there are comments for the ChangeSet
file. Otherwise, the button is the Checkin button which signifies that
the files will be checked in, but no ChangeSet will be created. The
Checkin feature is useful when checkpointing files to save state when
you know you want to make changes that may break things. Other times
you want to checkpoint when you've created distinct new work and want
to get back to it in the future.
.LP
Typical usage is to move to each file, add comments, and repeat
until done. When all files are commented and a comment exists for
the ChangeSet file, the
.B commit
button is pressed to make the changes part of a ChangeSet. Citool's
default behavior is to exit after the commit finishes. However, the
ci.rescan configuration option forces citool to rescan the repository
for files that still need to be added to a changeset. This feature is
useful when modifying files that should be in separate changesets. For
example, if you modify five files and three of those files form a
logical unit of work, you can start citool, add the three files to a
changeset and then commit. After commiting the files to a changeset,
citool returns so that you can comment the remaining files and add
them to a new changeset. Basically, this option prevents the user
from restarting citool multiple times if all files are not added to
a changeset.
.LP
You can move around within the file list by clicking on a file name or using 
the keyboard accelerators Control-n (next file) and Control-p (previous file).
You may add comments, move around, come back, and update the comments.
The comments are not applied to the files until 
.BR [Commit]
is clicked.
.LP
The question mark icon to the left of the file name denotes files that 
are not under revision control. To add the new files to the changeset, 
click on the question mark icon or use the Control-t key to add the file 
to the current changeset.  Clicking on the question mark changes the icon to
a check mark, indicating that the file will be part of the cset.
.LP
Some of the new files might be files that you do not wish to put
under revision control and having them visible clutters up the file
window. When a new file is highlighted, the 
.B Ignore
button is
activated on the button bar menu. If you click the ignore button,
the selected file will be added to the BitKeeper/etc/ignore file
so that when citool is run again, the selected file will not be
shown. If you accidentally click ignore on a file that you want, click
the
.B Unignore
button. The \*(BK /etc/ignore file is not updated
until the changeset is committed. The ignore file is a revision
controlled file like any other \*(BK file and can be edited with a
text editor if you want to remove or add files to the ignore list.
The entries that are selected to be ignored are not added to the ignore 
file until the changeset is committed.
.LP
At times, you might wish to exclude files from a changeset. For
example, if you are working on a file and have made changes to
it (changes can be committed and in the pending state), but don't
want these changes to propagate when you push your work to another
repository. To exclude files from the changeset, use the left mouse
button to click on the file-type icon.  If the file can be excluded,
the icon will change to a red X. If you try to exclude a pending
file while a modified version of the file exists, both the pending
and the modified file will be excluded. It is possible to exclude
the modified file, while keeping the pending file in an included state.
.LP
When you move to a file, the differences for this file are shown in the
bottom window.  When entering comments, it is normal to want to scroll
the differences window (assuming that the differences are larger than
the window).  While this can be done using the mouse and the scrollbar,
the following keyboard accelerators will work at all times, even when
typing in the comments window:
.SH "KEYBOARD BINDINGS"
.if t .TP 1.2i
.if n .TP 1.7i
.B Home
Scroll to the start of the differences
.tp
.B End
Scroll to the end of the differences
.tp
.B PageUp
Scroll the differences up 1 screen
.tp
.B PageDown
Scroll the differences down 1 screen
.tp
.B Shift-DownArrow
Scroll the differences down 1 line
.tp
.B Shift-UpArrow
Scroll the differences up 1 line
.tp
.B MouseWheel
Scroll the differences 1 screen 
.tp
.B Shift-MouseWheel
Scroll the file list window 1 screen
.if t .TP 1.2i
.if n .TP 1.7i
.B Control-c
Copy the contents of the comments window to the cut buffer.
.tp
.B Control-x
Delete the contents of the comments window, saving in the cut buffer.
.tp
.B Control-v
Paste the contents of the cut buffer into the comments window and
advance to the next file.
.tp
.B Middle-Button
On Unix, this will paste the X11 selection buffer into the comments window.
.if t .TP 1.2i
.if n .TP 1.7i
.B Control-n
Go to the next file
.tp
.B Control-p
Go to the previous file
.tp
.B Control-l
Rerun the diffs in case an external program has changed the file.
.tp
.B Control-t
Toggle include/exclude state and/or add/don't add state.  See the text
about include/exclude and new files.
.tp
.B Control-T
Toggle all new files into or out off the changeset. 
.tp
.B Control-Enter
Do the commit. Same as clicking on the Commit button.
.tp
.B Control-q
Same as clicking the [Quit] button.
.if t .TP 1.2i
.if n .TP 1.7i
.B Control-b
Scroll the differences up 1 screen
.tp
.B Control-f
Scroll the differences down 1 screen
.tp
.B Control-u
Scroll the differences up 1/2 screen
.tp
.B Control-d
Scroll the differences down 1/2 screen
.tp
.B Control-e
Scroll the differences down 1 line
.tp
.B Control-y
Scroll the differences up 1 line
.SH "EDITING THE COMMENTS"
.LP
The comments window is a standard TK text widget with word and line 
erase added.  Moving around is down with the arrow keys, backspace
to delete the previous character, Control-w (or Alt-w) to erase a word, and
Alt-u to erase a line.
.SH BUTTONS
.LP
There are a series of buttons on the right.  They perform the following
functions:
.if t .TP 1.2i
.if n .TP 1.7i
.B [Cut comments]
takes the contents of the current comment window and saves them in a buffer.
.tp
.B [Paste comments]
pastes comments saved by the previous button, overwriting any existing comments.
.tp
.B [Commit]
displays all comments in the differences window and asks if you want to commit.
.tp
.B [Edit]
a pull down menu, giving you the choice of running a simple TK based editor
or your $EDITOR on the current file.  Saving the file in the editor will
overwrite the current file.  The pull down also has an option to 
pop you into bk fmtool on the checked in version and the current version
of the file.   You may then select the changes you do not want to keep
and "merge" the two versions to a new version, which will replace the 
current file.
.tp
.B [History]
starts up revtool on the current file
.tp
.B [Diff tool]
starts up difftool on the previous/current versions of the file.
.tp
.B [Discard]
destroys the changes made to the current file, in other words,
throws away the differences.
.tp
.B [Ignore]
When a new file is selected, the ignore button will add the selected 
file to the \*(BK /etc/ignore file.
.tp
.B [Unignore]
When a new file is selected and is in the ignore state, the Unignore button 
prevents the selected file from being added to the \*(BK /etc/ignore file.
.tp
.B [Help]
Starts up the \*(BK help tool and displays this help.
.tp
.B [Quit]
Quits.  If you have provided comments, this will prompt you to save your
comments or discard you comments.
.SH LOCKING
.LP 
If the repository is locked, and you try to
.BR commit ,
the
.B commit
will fail.
You can wait for the lock to go away and then try the
.B commit
again; it should succeed.  If the lock is an invalid one (left over from an old
remote update), then you can switch to another window and unlock the
repository.   After it is unlocked, the
.B commit
should work.
.SH SEE ALSO
.SA ci 1
.SA config-gui
.SA fmtool 1
.SA ignore 1
.SA sfiles 1
.SH CATEGORY
.B GUI-tools
.br
.B Common
.br
.B Repository
