.so bk-macros
.TH "bk import" 1 20%E% "\*(BC" "\*(UM"
.\"    ================= Importing files into BitKeeper =================
.SH NAME
bk import \- import a set of files into a \*(BK package
.SH SYNOPSIS
.Bc bk import [-CfHqvr] [
.OPTreq \-S s
.B ] \-tpatch
.ARG patch
.ARG dest
.br
.Bc bk import [-CfHiqvx] [
.OPTreq \-S s
.Bc ] [
.OPTreq \-l f
.B ] \-tplain
.ARG dir
.ARG dest
.br
.Bc bk import [-CfHiqvx] [
.OPTreq \-S s
.Bc ] [
.OPTreq \-l f
.B ] \-tSCCS
.ARG dir
.ARG dest
.br
.Bc bk import [-ACfHiquvx] [
.OPTreq \-c tag
.Bc ] [
.OPTreq \-j n
.Bc ] [
.OPTreq \-l f
.Bc ] [
.OPTreq \-S s
.Bc ] \-t
.ARGc CVS
.Bc |
.ARG RCS
.ARG dir
.ARG dest
.SH DESCRIPTION
.LP
Use bk import to put non-\*(BK files into a \*(BK package.  Non-\*(BK files
include plain text files, patches (diffs), SCCS, CVS, and RCS files.
bk import leaves the original files intact.
.LP
In the case of CVS, RCS, SCCS files,
import should only be invoked once into a destination package.
It can be used repeatedly if you are importing 
traditional (or alien) patches into a repository over time.  
.LP
A more detailed explanation of importing the different types of files
can be found below.
.\"You can import files by specifying the directory
.\"containing files for import (Note: All files under the directory will
.\"be imported.  If a subset is desired, specify using a list or run 
.\"interactively.)
.\".DS
.\"bk import /path/to/src_files /path/to/package
.\".DE
.\".LP
.\"You may also specify files to import using an external list.  The
.\"path names of files in the list must be relative to the source directory.
.\".DS
.\"bk import -l/tmp/list ~/src/files ~/package
.\".DE
.\"bk import can be run interactively to include and exclude files using
.\"regular expressions.
.\".DS
.\"bk import -i ~/src_files ~/package
.\"End patterns with "." by itself or EOF
.\"Include>> *.c
.\"Include>> *.h
.\"Include>> Makefile
.\"Include>> .
.\".DE
.\"To import from a CVS tree:
.\".DS
.\"bk import -v -tCVS warehouse new
.\".DE
.SH OPTIONS
.if t .TP
.if n .TP 1i
.B \-A
Attic processing (CVS import only).  Moves all files which do not have
name conflicts from the Attic subdirectories to the enclosing repository,
i.e., "mv Attic/*,v .".
.tp
.B \-C
Do not commit the ChageSet.
.tp
.OPTreq \-c tag
do not import anything after
.ARG tag .
(RCS/CVS only)
.tp
.B \-f
Force; do not prompt for list editing.
.tp
.B \-H 
do not pass \-h option to rcs2sccs (turns off verification, faster, unsafe).
.tp
.B \-i
Like \-x but includes only files which match.
.tp
.OPTreq \-j n
n-way parallel for RCS conversion.
.tp
.OPTreq \-l f
Use the list of files in 
.ARG f .
.tp
.B \-q
Be quiet.
.tp
.B \-r
Do not do rename processing when doing patch imports. (Patch only.)
.tp
.OPTreq \-S s
Add tag 
.ARG s
to the changeset created around the import
.tp
.OPTreq \-t type
Specify import file type.  
.ARG type
can be one of:
.if t .RS .5i
.if n .RS .3i
.tp
.B plain
Import plain text files
.tp
.B patch
Import a patch (diffs)
.tp
.B RCS
Import RCS files
.tp
.B CVS
Import CVS files
.tp
.B SCCS
Import SCCS files
.RE
.tp
.B \-u
Run files through bk undos first; this will convert
DOS style end of lines to Unix style end of lines.
(CVS/RCS only.)
.tp
.B \-v
Be verbose.
.tp
.B \-x
Prompts for a regular expression to apply to the list
of files.  All matches are excluded.
.SH "IMPORTING PATCHES"
.LP
Importing patches can be done multiple times into a package.  
A rename in import is the deletion of one file followed by the
creation of another file.  Thus, import handles
file renames in the following way: 
it remembers all the deleted files
and all the new files and then launches bk renametool for the
user to manually match a deleted file with a new file.
.DS
bk import -tpatch patch_file destination_repository
.DE
.SH "IMPORTING CVS OR RCS FILES"
.LP
bk import will assume that the default branch of the CVS tree
is the one to be imported, other branches are discarded.  
Metadata from the CVS/RCS files is preserved upon import.
.DS
bk import -v -tCVS warehouse ~/new_package
.DE
.LP
This is a one time only import.  Importing to a clone of the destination 
package is advised in case the import fails, the package won't get
corrupted.  
.LP
The type of import requires RCS 5.6 or later.
.SH "IMPORTING PLAIN TEXT"
.LP
Importing a plain text file into a \*(BK package can only be done once.
If there is already a file in the package that has the same name as a
file to be imported the import will fail.  
.LP
If a package is already
populated with files use the -i, -x or -l options 
to avoid trying to import files already in the package.  Because of the
preceeding constraints, import does not catch renames with plain text files.
If a file has been renamed, it can be imported, but the original file will
still exist in the package so it is necessary to remove the original file
from the package tree after the import of the renamed file.
.LP
Plain text files can be imported from a directory, 
.DS
bk import /path/to/src_files ~/package
.DE
from a list of files relative to the source directory, 
.DS
bk import -l/tmp/list /path/to/src_files ~/package
.DE
or by using regular expressions in interactive mode
.DS
bk import -ix ~/src_files ~/package
End patterns with . by itself or EOF
File name pattern to include>> *.c
File name pattern to include>> *.h
File name pattern to include>> Makefile
File name pattern to include>> .
End patterns with . by itself or EOF
File name pattern to exclude>> *.o
File name pattern to exclude>> .
.DE
.SH "IMPORTING SCCS FILES"
.LP
Teamware and other SCCS files can be imported.  The history of the file is preserved, but
the unmerged branches are discarded.  This is okay because the necessary 
metadata is in the mainline.  
.DS
bk import -tSCCS /path/to/src_files ~/package
.DE
.LP
Importing \*(BK files is not supported; use bk clone.
.SH "ERROR HANDLING"
.LP
Import does not handle errors in a robust way.  If unsuccessful, import
may leave work half done in the destination package.  It is suggested that
the import destination repository is a clone of the original package in case of
a failed import.
.SH "SEE ALSO"
.SA rcs2sccs 1
.SA undos 1
.SH CATEGORY
.B Repository
